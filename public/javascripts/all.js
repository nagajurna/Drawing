"use strict";function DragAndDropService(e,t,f,s){var o={},p=function(t){t.preventDefault(),t.target.style.cursor="move",o.xDif=t.screenX-e.offsetLeft,o.yDif=t.screenY-e.offsetTop},n=function(p){p.preventDefault(),o.xDif&&(e.style.left=p.screenX-o.xDif+"px",e.style.top=p.screenY-o.yDif+"px",t.style.top=e.offsetTop-t.offsetHeight+"px",t.style.left=e.offsetLeft-t.offsetWidth+"px",f.style.top=e.offsetTop+e.offsetHeight+"px",f.style.left=e.offsetLeft+e.offsetWidth+"px",s.style.top=e.offsetTop-s.offsetHeight+"px",s.style.left=(e.offsetWidth-s.offsetWidth)/2+e.offsetLeft+"px")},r=function(e){e.preventDefault(),e.target.style.cursor="grab",e.target.style.cursor="-webkit-grab",o={}},i=function(t){var f=t.touches[0];o.xDif=f.screenX-e.offsetLeft,o.yDif=f.screenY-e.offsetTop},c=function(p){var n=p.touches[0];p.preventDefault(),o.xDif&&(e.style.left=n.screenX-o.xDif+"px",e.style.top=n.screenY-o.yDif+"px",t.style.top=e.offsetTop-t.offsetHeight+"px",t.style.left=e.offsetLeft-t.offsetWidth+"px",f.style.top=e.offsetTop+e.offsetHeight+"px",f.style.left=e.offsetLeft+e.offsetWidth+"px",s.style.top=e.offsetTop-s.offsetHeight+"px",s.style.left=(e.offsetWidth-s.offsetWidth)/2+e.offsetLeft+"px")},u=function(e){o={}};s.addEventListener("mousedown",p,{capture:!1}),document.addEventListener("mousemove",n,{capture:!1}),s.addEventListener("mouseup",r,{capture:!1}),s.addEventListener("touchstart",i,{capture:!1}),document.addEventListener("touchmove",c,{capture:!1,passive:!1}),s.addEventListener("touchend",u,{capture:!1})}
"use strict";function DrawService(e,t,n,o,i){var s=t.canvas,a=!1,f={},c={},u=function(s){s.preventDefault(),1===s.which&&(n.disabled=!1,o.disabled=!1,i.disabled=!1,a=!0,f={x:s.clientX-e.offsetLeft,y:s.clientY-e.offsetTop},t.beginPath(),t.moveTo(f.x,f.y),t.lineTo(f.x,f.y),t.stroke())},d=function(n){n.preventDefault(),a===!0&&(c={x:n.clientX-e.offsetLeft,y:n.clientY-e.offsetTop},t.beginPath(),t.moveTo(f.x,f.y),t.lineTo(c.x,c.y),t.stroke(),f=c)},r=function(){a=!1},v=function(t){n.disabled=!1,o.disabled=!1,i.disabled=!1;var s=t.touches[0];a=!0,f={x:s.clientX-e.offsetLeft,y:s.clientY-e.offsetTop}},l=function(n){n.preventDefault();var o=n.touches[0];if(a){var i={x:o.clientX-e.offsetLeft,y:o.clientY-e.offsetTop};t.beginPath(),t.moveTo(f.x,f.y),t.lineTo(i.x,i.y),t.stroke(),f=i}},p=function(e){a=!1};s.addEventListener("mouseout",function(){a=!1},!1),s.addEventListener("mousedown",u,{capture:!1}),s.addEventListener("mousemove",d,{capture:!1}),s.addEventListener("mouseup",r,{capture:!1}),s.addEventListener("touchstart",v,{capture:!1,passive:!0}),s.addEventListener("touchmove",l,{capture:!1,passive:!1}),s.addEventListener("touchend",p,{capture:!1,passive:!0})}
"use strict";function Drawing(){var e=document.getElementById("container"),t=document.getElementById("image"),n=document.getElementById("canvas"),d=n.getContext("2d"),o=document.getElementById("nwHandle"),i=document.getElementById("seHandle"),a=document.getElementById("dragHandle"),s=document.getElementById("convert"),l=document.getElementById("save"),f=document.getElementById("new"),c=document.getElementById("lineWidthSelect"),r=document.getElementById("strokeStyleSelect"),m=!1,u=(DrawService(e,d,s,l,f),ResizeService(e,d,o,i,a,c,r),DragAndDropService(e,o,i,a),function(){d.canvas.width=e.offsetWidth,d.canvas.height=e.offsetHeight,d.lineWidth=parseInt(c.value),d.strokeStyle=r.value,d.lineJoin=d.lineCap="round",d.fillStyle="#ffffff",d.fillRect(0,0,d.canvas.width,d.canvas.height),e.style.left=(window.innerWidth-e.offsetWidth)/2+"px",o.style.top=e.offsetTop-o.offsetHeight+"px",o.style.left=e.offsetLeft-o.offsetWidth+"px",i.style.top=e.offsetTop+e.offsetHeight+"px",i.style.left=e.offsetLeft+e.offsetWidth+"px",a.style.top=e.offsetTop-a.offsetHeight+"px",a.style.left=(e.offsetWidth-a.offsetWidth)/2+e.offsetLeft+"px",s.disabled=!0,l.disabled=!0,f.disabled=!0});document.onload=u();var h=function(){e.style.left=(window.innerWidth-e.offsetWidth)/2+"px",o.style.top=e.offsetTop-o.offsetHeight+"px",o.style.left=e.offsetLeft-o.offsetWidth+"px",i.style.top=e.offsetTop+e.offsetHeight+"px",i.style.left=e.offsetLeft+e.offsetWidth+"px",a.style.top=e.offsetTop-a.offsetHeight+"px",a.style.left=(e.offsetWidth-a.offsetWidth)/2+e.offsetLeft+"px"};window.addEventListener("resize",h,!1),window.addEventListener("load",function(e){window.scrollTo(0,0),e.currentTarget.innerWidth<768&&E(document.getElementById("flash"),"Draw !")},!1),document.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1});var p=function(){d.lineWidth=parseInt(c.value)};c.addEventListener("change",p,{capture:!1});var v=function(){d.strokeStyle=r.value};r.addEventListener("change",v,{capture:!1});var g=function(){m=!1;var e=n.toDataURL().replace(/^data:image\/\w+;base64,/,""),t=document.createElement("input");t.setAttribute("name","data"),t.setAttribute("value",e),t.setAttribute("type","hidden");var d=document.createElement("form");d.method="post",d.action="/save",d.appendChild(t),document.body.appendChild(d),d.submit(),document.body.removeChild(d)};l.addEventListener("click",g,!1);var y=function(e){m===!1?(m=!0,t.src=d.canvas.toDataURL("image/png"),c.disabled=!0,r.disabled=!0,document.body.className="image",e.target.innerHTML="To drawing",E(document.getElementById("flash"),"Long touch to save")):(m=!1,c.disabled=!1,r.disabled=!1,document.body.className="canvas",e.target.innerHTML="To image")};s.addEventListener("click",y,!1);var E=function(t,n){t.innerHTML=n,t.style.display="block",t.style.left=(e.offsetWidth-t.offsetWidth)/2+"px",window.setTimeout(function(){t.style.display="none"},1200)},b=function(){m=!1,s.disabled=!0,l.disabled=!0,f.disabled=!0,c.disabled=!1,r.disabled=!1,document.body.className="canvas",s.innerHTML="To image",d.canvas.width=e.offsetWidth,d.canvas.height=e.offsetHeight,d.lineWidth=parseInt(document.getElementById("lineWidthSelect").value);for(var t=r.getElementsByTagName("option"),n=0;n<t.length;n++)"#000"===t[n].value?t[n].selected=!0:t[n].selected=!1;d.strokeStyle=document.getElementById("strokeStyleSelect").value,d.lineJoin=d.lineCap="round",d.fillStyle="#ffffff",d.fillRect(0,0,d.canvas.width,d.canvas.height)};f.addEventListener("click",b,!1)}
"use strict";function ResizeService(t,e,f,s,o,a,i){var n=!1,l=!1,h=function(t){t.preventDefault(),"seHandle"===t.target.id&&(n=!0),"nwHandle"===t.target.id&&(l=!0)},c=function(a){if(n===!0){a.preventDefault(),a.target.style.cursor="nwse-resize";var i=t.offsetHeight-(t.offsetHeight+t.offsetTop-a.clientY),h=t.offsetWidth-(t.offsetWidth+t.offsetLeft-a.clientX);t.style.height=i+"px",t.style.width=h+"px",f.style.top=t.offsetTop-f.offsetHeight+"px",f.style.left=t.offsetLeft-f.offsetWidth+"px",s.style.top=t.offsetTop+t.offsetHeight+"px",s.style.left=t.offsetLeft+t.offsetWidth+"px",o.style.top=t.offsetTop-o.offsetHeight+"px",o.style.left=(t.offsetWidth-o.offsetWidth)/2+t.offsetLeft+"px"}else if(l===!0){a.preventDefault(),a.target.style.cursor="nwse-resize";var c=t.offsetLeft-(t.offsetLeft-a.clientX),p=t.offsetTop-(t.offsetTop-a.clientY),d=t.offsetWidth+(t.offsetLeft-c),v=t.offsetHeight+(t.offsetTop-p),r=canvas.offsetLeft+(t.offsetLeft-c),u=canvas.offsetTop+(t.offsetTop-p);t.style.left=c+"px",t.style.top=p+"px",t.style.width=d+"px",t.style.height=v+"px",e.canvas.style.left=r+"px",e.canvas.style.top=u+"px",f.style.top=t.offsetTop-f.offsetHeight+"px",f.style.left=t.offsetLeft-f.offsetWidth+"px",s.style.top=t.offsetTop+t.offsetHeight+"px",s.style.left=t.offsetLeft+t.offsetWidth+"px",o.style.top=t.offsetTop-o.offsetHeight+"px",o.style.left=(t.offsetWidth-o.offsetWidth)/2+t.offsetLeft+"px"}},p=function(f){if(f.preventDefault(),n===!0){n=!1,e.canvas.style.cursor="pointer",document.body.style.cursor="default";var s=e.canvas.toDataURL();e.canvas.width=t.offsetWidth,e.canvas.height=t.offsetHeight,e.fillStyle="#ffffff",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.lineWidth=a.value,e.strokeStyle=i.value,e.lineJoin=e.lineCap="round";var o=new Image;o.onload=function(){e.drawImage(o,0,0,e.canvas.width,e.canvas.height,0,0,e.canvas.width,e.canvas.height)},o.src=s}else l===!0&&!function(){l=!1,e.canvas.style.cursor="pointer",document.body.style.cursor="default";var f=e.canvas.toDataURL();e.canvas.width=t.offsetWidth,e.canvas.height=t.offsetHeight,e.canvas.style.left="0px",e.canvas.style.top="0px",e.fillStyle="#ffffff",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.lineWidth=a.value,e.strokeStyle=i.value,e.lineJoin=e.lineCap="round";var s=new Image;s.onload=function(){e.drawImage(s,s.width-e.canvas.width,s.height-e.canvas.height,e.canvas.width,e.canvas.height,0,0,e.canvas.width,e.canvas.height)},s.src=f}()},d=function(t){var e=t.touches[0];"seHandle"===e.target.id&&(n=!0),"nwHandle"===e.target.id&&(l=!0)},v=function(a){var i=a.touches[0];if(n===!0){a.preventDefault();var h=t.offsetHeight-(t.offsetHeight+t.offsetTop-i.clientY),c=t.offsetWidth-(t.offsetWidth+t.offsetLeft-i.clientX);t.style.height=h+"px",t.style.width=c+"px",f.style.top=t.offsetTop-f.offsetHeight+"px",f.style.left=t.offsetLeft-f.offsetWidth+"px",s.style.top=t.offsetTop+t.offsetHeight+"px",s.style.left=t.offsetLeft+t.offsetWidth+"px",o.style.top=t.offsetTop-o.offsetHeight+"px",o.style.left=(t.offsetWidth-o.offsetWidth)/2+t.offsetLeft+"px"}else if(l===!0){a.preventDefault();var p=t.offsetLeft-(t.offsetLeft-i.clientX),d=t.offsetTop-(t.offsetTop-i.clientY),v=t.offsetWidth+(t.offsetLeft-p),r=t.offsetHeight+(t.offsetTop-d),u=canvas.offsetLeft+(t.offsetLeft-p),g=canvas.offsetTop+(t.offsetTop-d);t.style.left=p+"px",t.style.top=d+"px",t.style.width=v+"px",t.style.height=r+"px",e.canvas.style.left=u+"px",e.canvas.style.top=g+"px",f.style.top=t.offsetTop-f.offsetHeight+"px",f.style.left=t.offsetLeft-f.offsetWidth+"px",s.style.top=t.offsetTop+t.offsetHeight+"px",s.style.left=t.offsetLeft+t.offsetWidth+"px",o.style.top=t.offsetTop-o.offsetHeight+"px",o.style.left=(t.offsetWidth-o.offsetWidth)/2+t.offsetLeft+"px"}},r=function(f){n===!0?!function(){n=!1;var f=e.canvas.toDataURL();e.canvas.width=t.offsetWidth,e.canvas.height=t.offsetHeight,e.fillStyle="#ffffff",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.lineWidth=a.value,e.strokeStyle=i.value,e.lineJoin=e.lineCap="round";var s=new Image;s.onload=function(){e.drawImage(s,0,0,e.canvas.width,e.canvas.height,0,0,e.canvas.width,e.canvas.height)},s.src=f}():l===!0&&!function(){l=!1;var f=e.canvas.toDataURL();e.canvas.width=t.offsetWidth,e.canvas.height=t.offsetHeight,e.canvas.style.left="0px",e.canvas.style.top="0px",e.fillStyle="#ffffff",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.lineWidth=a.value,e.strokeStyle=i.value,e.lineJoin=e.lineCap="round";var s=new Image;s.onload=function(){e.drawImage(s,s.width-e.canvas.width,s.height-e.canvas.height,e.canvas.width,e.canvas.height,0,0,e.canvas.width,e.canvas.height)},s.src=f}()};s.addEventListener("mousedown",h,{capture:!1}),f.addEventListener("mousedown",h,{capture:!1}),document.addEventListener("mousemove",c,{capture:!1}),document.addEventListener("mouseup",p,{capture:!1}),s.addEventListener("touchstart",d,{capture:!1}),f.addEventListener("touchstart",d,{capture:!1}),document.addEventListener("touchmove",v,{capture:!1,passive:!1}),document.addEventListener("touchend",r,{capture:!1})}
"use strict";var drawing=Drawing();