"use strict";function Drawing(){var e=document.getElementById("container"),t=document.getElementById("image"),n=document.getElementById("canvas"),d=n.getContext("2d"),o=document.getElementById("nwHandle"),i=document.getElementById("seHandle"),a=document.getElementById("dragHandle"),s=document.getElementById("convert"),l=document.getElementById("save"),f=document.getElementById("new"),c=document.getElementById("lineWidthSelect"),r=document.getElementById("strokeStyleSelect"),m=!1,u=(DrawService(e,d,s,l,f),ResizeService(e,d,o,i,a,c,r),DragAndDropService(e,o,i,a),function(){d.canvas.width=e.offsetWidth,d.canvas.height=e.offsetHeight,d.lineWidth=parseInt(c.value),d.strokeStyle=r.value,d.lineJoin=d.lineCap="round",d.fillStyle="#ffffff",d.fillRect(0,0,d.canvas.width,d.canvas.height),e.style.left=(window.innerWidth-e.offsetWidth)/2+"px",o.style.top=e.offsetTop-o.offsetHeight+"px",o.style.left=e.offsetLeft-o.offsetWidth+"px",i.style.top=e.offsetTop+e.offsetHeight+"px",i.style.left=e.offsetLeft+e.offsetWidth+"px",a.style.top=e.offsetTop-a.offsetHeight+"px",a.style.left=(e.offsetWidth-a.offsetWidth)/2+e.offsetLeft+"px",s.disabled=!0,l.disabled=!0,f.disabled=!0});document.onload=u();var h=function(){e.style.left=(window.innerWidth-e.offsetWidth)/2+"px",o.style.top=e.offsetTop-o.offsetHeight+"px",o.style.left=e.offsetLeft-o.offsetWidth+"px",i.style.top=e.offsetTop+e.offsetHeight+"px",i.style.left=e.offsetLeft+e.offsetWidth+"px",a.style.top=e.offsetTop-a.offsetHeight+"px",a.style.left=(e.offsetWidth-a.offsetWidth)/2+e.offsetLeft+"px"};window.addEventListener("resize",h,!1),window.addEventListener("load",function(e){window.scrollTo(0,0),e.currentTarget.innerWidth<768&&E(document.getElementById("flash"),"Draw !")},!1),document.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1});var p=function(){d.lineWidth=parseInt(c.value)};c.addEventListener("change",p,{capture:!1});var v=function(){d.strokeStyle=r.value};r.addEventListener("change",v,{capture:!1});var g=function(){m=!1;var e=n.toDataURL().replace(/^data:image\/\w+;base64,/,""),t=document.createElement("input");t.setAttribute("name","data"),t.setAttribute("value",e),t.setAttribute("type","hidden");var d=document.createElement("form");d.method="post",d.action="/save",d.appendChild(t),document.body.appendChild(d),d.submit(),document.body.removeChild(d)};l.addEventListener("click",g,!1);var y=function(e){m===!1?(m=!0,t.src=d.canvas.toDataURL("image/png"),c.disabled=!0,r.disabled=!0,document.body.className="image",e.target.innerHTML="To drawing",E(document.getElementById("flash"),"Long touch to save")):(m=!1,c.disabled=!1,r.disabled=!1,document.body.className="canvas",e.target.innerHTML="To image")};s.addEventListener("click",y,!1);var E=function(t,n){t.innerHTML=n,t.style.display="block",t.style.left=(e.offsetWidth-t.offsetWidth)/2+"px",window.setTimeout(function(){t.style.display="none"},1200)},b=function(){m=!1,s.disabled=!0,l.disabled=!0,f.disabled=!0,c.disabled=!1,r.disabled=!1,document.body.className="canvas",s.innerHTML="To image",d.canvas.width=e.offsetWidth,d.canvas.height=e.offsetHeight,d.lineWidth=parseInt(document.getElementById("lineWidthSelect").value);for(var t=r.getElementsByTagName("option"),n=0;n<t.length;n++)"#000"===t[n].value?t[n].selected=!0:t[n].selected=!1;d.strokeStyle=document.getElementById("strokeStyleSelect").value,d.lineJoin=d.lineCap="round",d.fillStyle="#ffffff",d.fillRect(0,0,d.canvas.width,d.canvas.height)};f.addEventListener("click",b,!1)}